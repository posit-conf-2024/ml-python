<!DOCTYPE html>
<html lang="en"><head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.56">

  <title>Introduction to machine learning in Python with Scikit-learn – Tree-based and ensemble models</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto.css">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
  
  <script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Tree-based and ensemble models</h1>

<div class="quarto-title-authors">
</div>

</section>
<section id="tree-based-methods" class="title-slide slide level2 center">
<h2>Tree-based methods</h2>
<ul>
<li class="fragment"><p>Algorithms that stratifying or segmenting the predictor space into a number of simple regions.</p></li>
<li class="fragment"><p>We call these algorithms decision-tree methods because the decisions used to segment the predictor space can be summarized in a tree.</p></li>
<li class="fragment"><p>Decision trees on their own, are very explainable and intuitive, but not very powerful at predicting.</p></li>
<li class="fragment"><p>However, there are extensions of decision trees, such as random forest and boosted trees, which are very powerful at predicting. We will demonstrate two of these in this session.</p></li>
</ul>
</section>

<section id="decision-trees" class="title-slide slide level2 center">
<h2>Decision trees</h2>
<div>
<ul>
<li><a href="https://mlu-explain.github.io/decision-tree/">Decision Trees</a><br>
by Jared Wilber &amp; Lucía Santamaría</li>
</ul>
</div>
</section>

<section id="classification-decision-trees" class="title-slide slide level2 center">
<h2>Classification Decision trees</h2>
<ul>
<li class="fragment"><p>Use recursive binary splitting to grow a classification tree (splitting of the predictor space into <span class="math inline">\(J\)</span> distinct, non-overlapping regions).</p></li>
<li class="fragment"><p>For every observation that falls into the region <span class="math inline">\(R_j\)</span> , we make the same prediction, which is the majority vote for the training observations in <span class="math inline">\(R_j\)</span>.</p></li>
<li class="fragment"><p>Where to split the predictor space is done in a top-down and greedy manner, and in practice for classification, the best split at any point in the algorithm is one that minimizes the Gini index (a measure of node purity).</p></li>
<li class="fragment"><p>Decision trees are useful because they are very interpretable.</p></li>
<li class="fragment"><p>A limitation of decision trees is that theyn tend to overfit, so in practice we use cross-validation to tune a hyperparameter, <span class="math inline">\(\alpha\)</span>, to find the optimal, pruned tree.</p></li>
</ul>
</section>

<section id="example-the-heart-data-set" class="title-slide slide level2 center">
<h2>Example: the heart data set</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div>
<ul>
<li><p>Let’s consider a situation where we’d like to be able to predict the presence of heart disease (<code>AHD</code>) in patients, based off 13 measured characteristics.</p></li>
<li><p>The <a href="https://www.statlearning.com/s/Heart.csv">heart data set</a> contains a binary outcome for heart disease for patients who presented with chest pain.</p></li>
</ul>
</div>
</div><div class="column" style="width:50%;">
<div id="b50ecb3f" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a></a>heart <span class="op">=</span> pd.read_csv(<span class="st">"data/Heart.csv"</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb1-3"><a></a>heart.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Index: 303 entries, 1 to 303
Data columns (total 14 columns):
 #   Column     Non-Null Count  Dtype  
---  ------     --------------  -----  
 0   Age        303 non-null    int64  
 1   Sex        303 non-null    int64  
 2   ChestPain  303 non-null    object 
 3   RestBP     303 non-null    int64  
 4   Chol       303 non-null    int64  
 5   Fbs        303 non-null    int64  
 6   RestECG    303 non-null    int64  
 7   MaxHR      303 non-null    int64  
 8   ExAng      303 non-null    int64  
 9   Oldpeak    303 non-null    float64
 10  Slope      303 non-null    int64  
 11  Ca         299 non-null    float64
 12  Thal       301 non-null    object 
 13  AHD        303 non-null    object 
dtypes: float64(2), int64(9), object(3)
memory usage: 35.5+ KB</code></pre>
</div>
</div>
</div></div>
</section>

<section id="example-the-heart-data-set-1" class="title-slide slide level2 center">
<h2>Example: the heart data set</h2>
<p>An angiographic test was performed and a label for <code>AHD</code> of Yes was labelled to indicate the presence of heart disease, otherwise the label was No.</p>
<div id="9e77ae41" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a></a>heart.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Sex</th>
<th data-quarto-table-cell-role="th">ChestPain</th>
<th data-quarto-table-cell-role="th">RestBP</th>
<th data-quarto-table-cell-role="th">Chol</th>
<th data-quarto-table-cell-role="th">Fbs</th>
<th data-quarto-table-cell-role="th">RestECG</th>
<th data-quarto-table-cell-role="th">MaxHR</th>
<th data-quarto-table-cell-role="th">ExAng</th>
<th data-quarto-table-cell-role="th">Oldpeak</th>
<th data-quarto-table-cell-role="th">Slope</th>
<th data-quarto-table-cell-role="th">Ca</th>
<th data-quarto-table-cell-role="th">Thal</th>
<th data-quarto-table-cell-role="th">AHD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>63</td>
<td>1</td>
<td>typical</td>
<td>145</td>
<td>233</td>
<td>1</td>
<td>2</td>
<td>150</td>
<td>0</td>
<td>2.3</td>
<td>3</td>
<td>0.0</td>
<td>fixed</td>
<td>No</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>67</td>
<td>1</td>
<td>asymptomatic</td>
<td>160</td>
<td>286</td>
<td>0</td>
<td>2</td>
<td>108</td>
<td>1</td>
<td>1.5</td>
<td>2</td>
<td>3.0</td>
<td>normal</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>67</td>
<td>1</td>
<td>asymptomatic</td>
<td>120</td>
<td>229</td>
<td>0</td>
<td>2</td>
<td>129</td>
<td>1</td>
<td>2.6</td>
<td>2</td>
<td>2.0</td>
<td>reversable</td>
<td>Yes</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>37</td>
<td>1</td>
<td>nonanginal</td>
<td>130</td>
<td>250</td>
<td>0</td>
<td>0</td>
<td>187</td>
<td>0</td>
<td>3.5</td>
<td>3</td>
<td>0.0</td>
<td>normal</td>
<td>No</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>41</td>
<td>0</td>
<td>nontypical</td>
<td>130</td>
<td>204</td>
<td>0</td>
<td>2</td>
<td>172</td>
<td>0</td>
<td>1.4</td>
<td>1</td>
<td>0.0</td>
<td>normal</td>
<td>No</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>

<section id="do-we-have-a-class-imbalance" class="title-slide slide level2 center">
<h2>Do we have a class imbalance?</h2>
<p>It’s always important to check this, as it may impact your splitting and/or modeling decisions.</p>
<div id="25125a5e" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a></a>heart[<span class="st">'AHD'</span>].value_counts(normalize<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>AHD
No     0.541254
Yes    0.458746
Name: proportion, dtype: float64</code></pre>
</div>
</div>
<p>This looks pretty good! We can move forward this time without doing much more about this.</p>
</section>

<section id="data-splitting" class="title-slide slide level2 center">
<h2>Data splitting</h2>
<p>Let’s split the data into training and test sets:</p>
<div id="4227b47f" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb6-2"><a></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb6-3"><a></a></span>
<span id="cb6-4"><a></a>np.random.seed(<span class="dv">2024</span>)</span>
<span id="cb6-5"><a></a></span>
<span id="cb6-6"><a></a>heart_train, heart_test <span class="op">=</span> train_test_split(</span>
<span id="cb6-7"><a></a>    heart, train_size<span class="op">=</span><span class="fl">0.8</span>, stratify<span class="op">=</span>heart[<span class="st">"AHD"</span>]</span>
<span id="cb6-8"><a></a>)</span>
<span id="cb6-9"><a></a></span>
<span id="cb6-10"><a></a>X_train <span class="op">=</span> heart_train.drop(columns<span class="op">=</span>[<span class="st">'AHD'</span>])</span>
<span id="cb6-11"><a></a>y_train <span class="op">=</span> heart_train[<span class="st">'AHD'</span>]</span>
<span id="cb6-12"><a></a>X_test <span class="op">=</span> heart_test.drop(columns<span class="op">=</span>[<span class="st">'AHD'</span>])</span>
<span id="cb6-13"><a></a>y_test <span class="op">=</span> heart_test[<span class="st">'AHD'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>

<section id="categorical-variables" class="title-slide slide level2 center">
<h2>Categorical variables</h2>
<div class="columns">
<div class="column" style="width:35%;">
<div>
<ul>
<li><p>This is our first case of seeing categorical predictor variables, can we treat them the same as numerical ones? <strong>No!</strong></p></li>
<li><p>In <code>scikit-learn</code> we must perform <strong>one-hot encoding</strong></p></li>
</ul>
</div>
</div><div class="column" style="width:65%;">
<p><img data-src="img/ensembles/onehot1-1-1.png"></p>
<p><em>Source: <a href="https://scales.arabpsychology.com/stats/how-can-i-perform-one-hot-encoding-in-r/" class="uri">https://scales.arabpsychology.com/stats/how-can-i-perform-one-hot-encoding-in-r/</a></em></p>
</div></div>
</section>

<section id="look-at-the-data-again" class="title-slide slide level2 center">
<h2>Look at the data again</h2>
<p>Which columns do we need to standardize?</p>
<p>Which do we need to one-hot encode?</p>
<div id="2fb414e2" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a></a>heart.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Sex</th>
<th data-quarto-table-cell-role="th">ChestPain</th>
<th data-quarto-table-cell-role="th">RestBP</th>
<th data-quarto-table-cell-role="th">Chol</th>
<th data-quarto-table-cell-role="th">Fbs</th>
<th data-quarto-table-cell-role="th">RestECG</th>
<th data-quarto-table-cell-role="th">MaxHR</th>
<th data-quarto-table-cell-role="th">ExAng</th>
<th data-quarto-table-cell-role="th">Oldpeak</th>
<th data-quarto-table-cell-role="th">Slope</th>
<th data-quarto-table-cell-role="th">Ca</th>
<th data-quarto-table-cell-role="th">Thal</th>
<th data-quarto-table-cell-role="th">AHD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>63</td>
<td>1</td>
<td>typical</td>
<td>145</td>
<td>233</td>
<td>1</td>
<td>2</td>
<td>150</td>
<td>0</td>
<td>2.3</td>
<td>3</td>
<td>0.0</td>
<td>fixed</td>
<td>No</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>67</td>
<td>1</td>
<td>asymptomatic</td>
<td>160</td>
<td>286</td>
<td>0</td>
<td>2</td>
<td>108</td>
<td>1</td>
<td>1.5</td>
<td>2</td>
<td>3.0</td>
<td>normal</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>67</td>
<td>1</td>
<td>asymptomatic</td>
<td>120</td>
<td>229</td>
<td>0</td>
<td>2</td>
<td>129</td>
<td>1</td>
<td>2.6</td>
<td>2</td>
<td>2.0</td>
<td>reversable</td>
<td>Yes</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>37</td>
<td>1</td>
<td>nonanginal</td>
<td>130</td>
<td>250</td>
<td>0</td>
<td>0</td>
<td>187</td>
<td>0</td>
<td>3.5</td>
<td>3</td>
<td>0.0</td>
<td>normal</td>
<td>No</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>41</td>
<td>0</td>
<td>nontypical</td>
<td>130</td>
<td>204</td>
<td>0</td>
<td>2</td>
<td>172</td>
<td>0</td>
<td>1.4</td>
<td>1</td>
<td>0.0</td>
<td>normal</td>
<td>No</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>

<section id="one-hot-encoding-pre-processing" class="title-slide slide level2 center">
<h2>One hot encoding &amp; pre-processing</h2>
<div id="9920d64d" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler, OneHotEncoder</span>
<span id="cb8-2"><a></a><span class="im">from</span> sklearn.compose <span class="im">import</span> make_column_transformer, make_column_selector</span>
<span id="cb8-3"><a></a></span>
<span id="cb8-4"><a></a>numeric_feats <span class="op">=</span> [<span class="st">'Age'</span>, <span class="st">'RestBP'</span>, <span class="st">'Chol'</span>, <span class="st">'RestECG'</span>, <span class="st">'MaxHR'</span>, <span class="st">'Oldpeak'</span>,<span class="st">'Slope'</span>, <span class="st">'Ca'</span>]</span>
<span id="cb8-5"><a></a>passthrough_feats <span class="op">=</span> [<span class="st">'Sex'</span>, <span class="st">'Fbs'</span>, <span class="st">'ExAng'</span>]</span>
<span id="cb8-6"><a></a>categorical_feats <span class="op">=</span> [<span class="st">'ChestPain'</span>, <span class="st">'Thal'</span>]</span>
<span id="cb8-7"><a></a></span>
<span id="cb8-8"><a></a>heart_preprocessor <span class="op">=</span> make_column_transformer(</span>
<span id="cb8-9"><a></a>    (StandardScaler(), numeric_feats), </span>
<span id="cb8-10"><a></a>    (<span class="st">"passthrough"</span>, passthrough_feats),     </span>
<span id="cb8-11"><a></a>    (OneHotEncoder(handle_unknown <span class="op">=</span> <span class="st">"ignore"</span>), categorical_feats),     </span>
<span id="cb8-12"><a></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote>
<p><code>handle_unknown = "ignore"</code> handles the case where categories exist in the test data, which were missing in the training set. Specifically, it sets the value for those to 0 for all cases of the category.</p>
</blockquote>
</section>

<section id="fitting-a-dummy-classifier" class="title-slide slide level2 center">
<h2>Fitting a dummy classifier</h2>
<div id="e854a9e5" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a></a><span class="im">from</span> sklearn.dummy <span class="im">import</span> DummyClassifier</span>
<span id="cb9-2"><a></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> make_pipeline</span>
<span id="cb9-3"><a></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> cross_validate</span>
<span id="cb9-4"><a></a></span>
<span id="cb9-5"><a></a>dummy <span class="op">=</span> DummyClassifier()</span>
<span id="cb9-6"><a></a>dummy_pipeline <span class="op">=</span> make_pipeline(heart_preprocessor, dummy)</span>
<span id="cb9-7"><a></a>cv_10_dummy <span class="op">=</span> pd.DataFrame(</span>
<span id="cb9-8"><a></a>    cross_validate(</span>
<span id="cb9-9"><a></a>        estimator<span class="op">=</span>dummy_pipeline,</span>
<span id="cb9-10"><a></a>        cv<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb9-11"><a></a>        X<span class="op">=</span>X_train,</span>
<span id="cb9-12"><a></a>        y<span class="op">=</span>y_train</span>
<span id="cb9-13"><a></a>    )</span>
<span id="cb9-14"><a></a>)</span>
<span id="cb9-15"><a></a>cv_10_dummy_metrics <span class="op">=</span> cv_10_dummy.agg([<span class="st">"mean"</span>, <span class="st">"sem"</span>])</span>
<span id="cb9-16"><a></a>results <span class="op">=</span> pd.DataFrame({<span class="st">'mean'</span> : [cv_10_dummy_metrics.test_score.iloc[<span class="dv">0</span>]],</span>
<span id="cb9-17"><a></a>  <span class="st">'sem'</span> : [cv_10_dummy_metrics.test_score.iloc[<span class="dv">1</span>]]},</span>
<span id="cb9-18"><a></a>  index <span class="op">=</span> [<span class="st">'Dummy classifier'</span>]</span>
<span id="cb9-19"><a></a>)</span>
<span id="cb9-20"><a></a>results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">sem</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Dummy classifier</td>
<td>0.541333</td>
<td>0.00299</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>

<section id="fitting-a-decision-tree" class="title-slide slide level2 center">
<h2>Fitting a decision tree</h2>
<div id="c6d5ecac" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb10-2"><a></a></span>
<span id="cb10-3"><a></a>decision_tree <span class="op">=</span> DecisionTreeClassifier(random_state<span class="op">=</span><span class="dv">2026</span>)</span>
<span id="cb10-4"><a></a></span>
<span id="cb10-5"><a></a>dt_pipeline <span class="op">=</span> make_pipeline(heart_preprocessor, decision_tree)</span>
<span id="cb10-6"><a></a>cv_10_dt <span class="op">=</span> pd.DataFrame(</span>
<span id="cb10-7"><a></a>    cross_validate(</span>
<span id="cb10-8"><a></a>        estimator<span class="op">=</span>dt_pipeline,</span>
<span id="cb10-9"><a></a>        cv<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb10-10"><a></a>        X<span class="op">=</span>X_train,</span>
<span id="cb10-11"><a></a>        y<span class="op">=</span>y_train</span>
<span id="cb10-12"><a></a>    )</span>
<span id="cb10-13"><a></a>)</span>
<span id="cb10-14"><a></a>cv_10_dt_metrics <span class="op">=</span> cv_10_dt.agg([<span class="st">"mean"</span>, <span class="st">"sem"</span>])</span>
<span id="cb10-15"><a></a>results_dt <span class="op">=</span> pd.DataFrame({<span class="st">'mean'</span> : [cv_10_dt_metrics.test_score.iloc[<span class="dv">0</span>]],</span>
<span id="cb10-16"><a></a>  <span class="st">'sem'</span> : [cv_10_dt_metrics.test_score.iloc[<span class="dv">1</span>]]},</span>
<span id="cb10-17"><a></a>  index <span class="op">=</span> [<span class="st">'Decision tree'</span>]</span>
<span id="cb10-18"><a></a>)</span>
<span id="cb10-19"><a></a>results <span class="op">=</span> pd.concat([results, results_dt])</span>
<span id="cb10-20"><a></a>results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">sem</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Dummy classifier</td>
<td>0.541333</td>
<td>0.00299</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Decision tree</td>
<td>0.769167</td>
<td>0.02632</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>

<section id="can-we-do-better" class="title-slide slide level2 center">
<h2>Can we do better?</h2>
<ul>
<li class="fragment"><p>We could tune some decision tree parameters (e.g., alpha, maximum tree depth, etc)…</p></li>
<li class="fragment"><p>We could also try a different tree-based method!</p></li>
<li class="fragment"><p><a href="https://mlu-explain.github.io/random-forest/">The Random Forest Algorithm</a> by Jenny Yeon &amp; Jared Wilber</p></li>
</ul>
</section>

<section id="the-random-forest-algorithm" class="title-slide slide level2 center">
<h2>The Random Forest Algorithm</h2>
<ol type="1">
<li class="fragment"><p>Build a number of decision trees on bootstrapped training samples.</p></li>
<li class="fragment"><p>When building the trees from the bootstrapped samples, at each stage of splitting, the best splitting is computed using a randomly selected subset of the features.</p></li>
<li class="fragment"><p>Take the majority votes across all the trees for the final prediction.</p></li>
</ol>
</section>

<section id="random-forest-in-scikit-learn-missing-values" class="title-slide slide level2 center">
<h2>Random forest in <code>scikit-learn</code> &amp; missing values</h2>
<div class="columns">
<div class="column" style="width:35%;">
<div>
<ul>
<li><p>Does not accept missing values, we need to deal with these somehow…</p></li>
<li><p>We can either drop the observations with missing values, or we can somehow impute them.</p></li>
<li><p>For the purposes of this demo we will drop them, but if you are interested in imputation, see the imputation tutorial in <a href="https://scikit-learn.org/stable/modules/impute.html"><code>scikit-learn</code></a></p></li>
</ul>
</div>
</div><div class="column" style="width:50%;">
<p>How many rows have missing observations:</p>
<div id="c4052378" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a></a>heart.isna().<span class="bu">any</span>(axis<span class="op">=</span><span class="dv">1</span>).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>np.int64(6)</code></pre>
</div>
</div>
<p>Drop rows with missing observations:</p>
<div id="164f2788" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a></a>heart_train_drop_na <span class="op">=</span> heart_train.dropna()</span>
<span id="cb13-2"><a></a></span>
<span id="cb13-3"><a></a>X_train_drop_na <span class="op">=</span> heart_train_drop_na.drop(</span>
<span id="cb13-4"><a></a>    columns<span class="op">=</span>[<span class="st">'AHD'</span>]</span>
<span id="cb13-5"><a></a>)</span>
<span id="cb13-6"><a></a>y_train_drop_na <span class="op">=</span> heart_train_drop_na[<span class="st">'AHD'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div></div>
</section>

<section id="random-forest-in-scikit-learn" class="title-slide slide level2 center">
<h2>Random forest in <code>scikit-learn</code></h2>
<div id="d8b8ae18" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb14-2"><a></a></span>
<span id="cb14-3"><a></a>random_forest <span class="op">=</span> RandomForestClassifier(random_state<span class="op">=</span><span class="dv">2026</span>)</span>
<span id="cb14-4"><a></a>rf_pipeline <span class="op">=</span> make_pipeline(heart_preprocessor, random_forest)</span>
<span id="cb14-5"><a></a>cv_10_rf <span class="op">=</span> pd.DataFrame(</span>
<span id="cb14-6"><a></a>    cross_validate(</span>
<span id="cb14-7"><a></a>        estimator<span class="op">=</span>rf_pipeline,</span>
<span id="cb14-8"><a></a>        cv<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb14-9"><a></a>        X<span class="op">=</span>X_train_drop_na,</span>
<span id="cb14-10"><a></a>        y<span class="op">=</span>y_train_drop_na</span>
<span id="cb14-11"><a></a>    )</span>
<span id="cb14-12"><a></a>)</span>
<span id="cb14-13"><a></a></span>
<span id="cb14-14"><a></a>cv_10_rf_metrics <span class="op">=</span> cv_10_rf.agg([<span class="st">"mean"</span>, <span class="st">"sem"</span>])</span>
<span id="cb14-15"><a></a>results_rf <span class="op">=</span> pd.DataFrame({<span class="st">'mean'</span> : [cv_10_rf_metrics.test_score.iloc[<span class="dv">0</span>]],</span>
<span id="cb14-16"><a></a>  <span class="st">'sem'</span> : [cv_10_rf_metrics.test_score.iloc[<span class="dv">1</span>]]},</span>
<span id="cb14-17"><a></a>  index <span class="op">=</span> [<span class="st">'Random forest'</span>]</span>
<span id="cb14-18"><a></a>)</span>
<span id="cb14-19"><a></a>results <span class="op">=</span> pd.concat([results, results_rf])</span>
<span id="cb14-20"><a></a>results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">sem</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Dummy classifier</td>
<td>0.541333</td>
<td>0.002990</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Decision tree</td>
<td>0.769167</td>
<td>0.026320</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Random forest</td>
<td>0.818297</td>
<td>0.017362</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>

<section id="can-we-do-better-1" class="title-slide slide level2 center">
<h2>Can we do better?</h2>
<ul>
<li class="fragment"><p>Random forest can be tuned a several important parameters, including:</p>
<ul>
<li class="fragment"><p><code>n_estimators</code>: number of decision trees (higher = more complexity)</p></li>
<li class="fragment"><p><code>max_depth</code>: max depth of each decision tree (higher = more complexity)</p></li>
<li class="fragment"><p><code>max_features</code>: the number of features you get to look at each split (higher = more complexity)</p></li>
</ul></li>
<li class="fragment"><p>We can use <code>GridSearchCV</code> to search for the optimal parameters for these, as we did for <span class="math inline">\(K\)</span> in <span class="math inline">\(K\)</span>-nearest neighbors.</p></li>
</ul>
</section>

<section id="tuning-random-forest-in-scikit-learn" class="title-slide slide level2 center">
<h2>Tuning random forest in <code>scikit-learn</code></h2>
<div id="218db336" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV</span>
<span id="cb15-2"><a></a></span>
<span id="cb15-3"><a></a>rf_param_grid <span class="op">=</span> {<span class="st">'randomforestclassifier__n_estimators'</span>: [<span class="dv">200</span>],</span>
<span id="cb15-4"><a></a>              <span class="st">'randomforestclassifier__max_depth'</span>: [<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>],</span>
<span id="cb15-5"><a></a>              <span class="st">'randomforestclassifier__max_features'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>]}</span>
<span id="cb15-6"><a></a></span>
<span id="cb15-7"><a></a>rf_tune_grid <span class="op">=</span> GridSearchCV(</span>
<span id="cb15-8"><a></a>    estimator<span class="op">=</span>rf_pipeline,</span>
<span id="cb15-9"><a></a>    param_grid<span class="op">=</span>rf_param_grid,</span>
<span id="cb15-10"><a></a>    cv<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb15-11"><a></a>    n_jobs<span class="op">=-</span><span class="dv">1</span> <span class="co"># tells computer to use all available CPUs</span></span>
<span id="cb15-12"><a></a>)</span>
<span id="cb15-13"><a></a>rf_tune_grid.fit(</span>
<span id="cb15-14"><a></a>    X_train_drop_na,</span>
<span id="cb15-15"><a></a>    y_train_drop_na</span>
<span id="cb15-16"><a></a>)</span>
<span id="cb15-17"><a></a></span>
<span id="cb15-18"><a></a>cv_10_rf_tuned_metrics <span class="op">=</span> pd.DataFrame(rf_tune_grid.cv_results_)</span>
<span id="cb15-19"><a></a>results_rf_tuned <span class="op">=</span> pd.DataFrame({<span class="st">'mean'</span> : rf_tune_grid.best_score_,</span>
<span id="cb15-20"><a></a>  <span class="st">'sem'</span> : pd.DataFrame(rf_tune_grid.cv_results_)[<span class="st">'std_test_score'</span>][<span class="dv">6</span>] <span class="op">/</span> <span class="dv">10</span><span class="op">**</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)},</span>
<span id="cb15-21"><a></a>  index <span class="op">=</span> [<span class="st">'Random forest tuned'</span>]</span>
<span id="cb15-22"><a></a>)</span>
<span id="cb15-23"><a></a>results <span class="op">=</span> pd.concat([results, results_rf_tuned])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>

<section id="random-forest-results" class="title-slide slide level2 center">
<h2>Random Forest results</h2>
<p>How did the Random Forest compare against the other models we tried?</p>
<div id="5d61e498" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a></a>results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">sem</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Dummy classifier</td>
<td>0.541333</td>
<td>0.002990</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Decision tree</td>
<td>0.769167</td>
<td>0.026320</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Random forest</td>
<td>0.818297</td>
<td>0.017362</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Random forest tuned</td>
<td>0.860688</td>
<td>0.022223</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>

<section id="boosting" class="title-slide slide level2 center">
<h2>Boosting</h2>
<ul>
<li class="fragment"><p>No randomization.</p></li>
<li class="fragment"><p>The key idea is combining many simple models called weak learners, to create a strong learner.</p></li>
<li class="fragment"><p>They combine multiple shallow (depth 1 to 5) decision trees.</p></li>
<li class="fragment"><p>They build trees in a serial manner, where each tree tries to correct the mistakes of the previous one.</p></li>
</ul>
</section>

<section id="tuning-gradientboostingclassifier-with-scikit-learn" class="title-slide slide level2 center">
<h2>Tuning <code>GradientBoostingClassifier</code> with <code>scikit-learn</code></h2>
<ul>
<li class="fragment"><p><code>GradientBoostingClassifier</code> can be tuned a several important parameters, including:</p>
<ul>
<li class="fragment"><p><code>n_estimators</code>: number of decision trees (higher = more complexity)</p></li>
<li class="fragment"><p><code>max_depth</code>: max depth of each decision tree (higher = more complexity)</p></li>
<li class="fragment"><p><code>learning_rate</code>: the shrinkage parameter which controls the rate at which boosting learns. Values between 0.01 or 0.001 are typical.</p></li>
</ul></li>
<li class="fragment"><p>We can use <code>GridSearchCV</code> to search for the optimal parameters for these, as we did for the parameters in Random Forest.</p></li>
</ul>
</section>

<section id="tuning-gradientboostingclassifier-with-scikit-learn-1" class="title-slide slide level2 center">
<h2>Tuning <code>GradientBoostingClassifier</code> with <code>scikit-learn</code></h2>
<div id="94c37916" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> GradientBoostingClassifier</span>
<span id="cb17-2"><a></a></span>
<span id="cb17-3"><a></a>gradient_boosted_classifier <span class="op">=</span> GradientBoostingClassifier(random_state<span class="op">=</span><span class="dv">2026</span>)</span>
<span id="cb17-4"><a></a>gb_pipeline <span class="op">=</span> make_pipeline(heart_preprocessor, gradient_boosted_classifier)</span>
<span id="cb17-5"><a></a>gb_param_grid <span class="op">=</span> {<span class="st">'gradientboostingclassifier__n_estimators'</span>: [<span class="dv">200</span>],</span>
<span id="cb17-6"><a></a>              <span class="st">'gradientboostingclassifier__max_depth'</span>: [<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>],</span>
<span id="cb17-7"><a></a>              <span class="st">'gradientboostingclassifier__learning_rate'</span>: [<span class="fl">0.001</span>, <span class="fl">0.005</span>, <span class="fl">0.01</span>]}</span>
<span id="cb17-8"><a></a>gb_tune_grid <span class="op">=</span> GridSearchCV(</span>
<span id="cb17-9"><a></a>    estimator<span class="op">=</span>gb_pipeline,</span>
<span id="cb17-10"><a></a>    param_grid<span class="op">=</span>gb_param_grid,</span>
<span id="cb17-11"><a></a>    cv<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb17-12"><a></a>    n_jobs<span class="op">=-</span><span class="dv">1</span> <span class="co"># tells computer to use all available CPUs</span></span>
<span id="cb17-13"><a></a>)</span>
<span id="cb17-14"><a></a>gb_tune_grid.fit(</span>
<span id="cb17-15"><a></a>    X_train_drop_na,</span>
<span id="cb17-16"><a></a>    y_train_drop_na</span>
<span id="cb17-17"><a></a>)</span>
<span id="cb17-18"><a></a></span>
<span id="cb17-19"><a></a>cv_10_gb_tuned_metrics <span class="op">=</span> pd.DataFrame(gb_tune_grid.cv_results_)</span>
<span id="cb17-20"><a></a>results_gb_tuned <span class="op">=</span> pd.DataFrame({<span class="st">'mean'</span> : gb_tune_grid.best_score_,</span>
<span id="cb17-21"><a></a>  <span class="st">'sem'</span> : pd.DataFrame(gb_tune_grid.cv_results_)[<span class="st">'std_test_score'</span>][<span class="dv">6</span>] <span class="op">/</span> <span class="dv">10</span><span class="op">**</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)},</span>
<span id="cb17-22"><a></a>  index <span class="op">=</span> [<span class="st">'Gradient boosted classifier tuned'</span>]</span>
<span id="cb17-23"><a></a>)</span>
<span id="cb17-24"><a></a>results <span class="op">=</span> pd.concat([results, results_gb_tuned])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>

<section id="gradientboostingclassifier-results" class="title-slide slide level2 center">
<h2><code>GradientBoostingClassifier</code> results</h2>
<p>How did the <code>GradientBoostingClassifier</code> compare against the other models we tried?</p>
<div id="a646d8ae" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a></a>results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">sem</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Dummy classifier</td>
<td>0.541333</td>
<td>0.002990</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Decision tree</td>
<td>0.769167</td>
<td>0.026320</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Random forest</td>
<td>0.818297</td>
<td>0.017362</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Random forest tuned</td>
<td>0.860688</td>
<td>0.022223</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Gradient boosted classifier tuned</td>
<td>0.851993</td>
<td>0.025671</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>

<section id="how-do-we-choose-the-final-model" class="title-slide slide level2 center">
<h2>How do we choose the final model?</h2>
<ul>
<li class="fragment"><p>Remember, what is your question or application?</p></li>
<li class="fragment"><p>A good rule when models are not very different (considering SEM), what is the simplest model that does well?</p></li>
<li class="fragment"><p>Look at other metrics that are important to you (not just the metric you used for tuning your model), remember precision &amp; recall, for example.</p></li>
<li class="fragment"><p>Remember - no peaking at the test set until you choose! And then, you should only look at the test set for one model!</p></li>
</ul>
</section>

<section id="precision-and-recall-on-the-tuned-random-forest-model" class="title-slide slide level2 center">
<h2>Precision and recall on the tuned random forest model</h2>
<div id="c2ddd8c5" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> make_scorer, precision_score, recall_score</span>
<span id="cb19-2"><a></a></span>
<span id="cb19-3"><a></a>scoring <span class="op">=</span> {</span>
<span id="cb19-4"><a></a>    <span class="st">'accuracy'</span>: <span class="st">'accuracy'</span>,</span>
<span id="cb19-5"><a></a>    <span class="st">'precision'</span>: make_scorer(precision_score, pos_label<span class="op">=</span><span class="st">'Yes'</span>),</span>
<span id="cb19-6"><a></a>    <span class="st">'recall'</span>: make_scorer(recall_score, pos_label<span class="op">=</span><span class="st">'Yes'</span>)</span>
<span id="cb19-7"><a></a>}</span>
<span id="cb19-8"><a></a></span>
<span id="cb19-9"><a></a>rf_tune_grid <span class="op">=</span> GridSearchCV(</span>
<span id="cb19-10"><a></a>    estimator<span class="op">=</span>rf_pipeline,</span>
<span id="cb19-11"><a></a>    param_grid<span class="op">=</span>rf_param_grid,</span>
<span id="cb19-12"><a></a>    cv<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb19-13"><a></a>    n_jobs<span class="op">=-</span><span class="dv">1</span>,</span>
<span id="cb19-14"><a></a>    scoring<span class="op">=</span>scoring,</span>
<span id="cb19-15"><a></a>    refit<span class="op">=</span><span class="st">'accuracy'</span></span>
<span id="cb19-16"><a></a>)</span>
<span id="cb19-17"><a></a></span>
<span id="cb19-18"><a></a>rf_tune_grid.fit(X_train_drop_na, y_train_drop_na)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<style>#sk-container-id-1 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-1 {
  color: var(--sklearn-color-text);
}

#sk-container-id-1 pre {
  padding: 0;
}

#sk-container-id-1 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-1 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-1 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-1 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-1 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-1 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-1 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-1 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-1 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-1 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-1 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-1 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-1 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-1 div.sk-label label.sk-toggleable__label,
#sk-container-id-1 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-1 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-1 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-1 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-1 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-1 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-1 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-1 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-1 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</a></style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GridSearchCV(cv=10,
             estimator=Pipeline(steps=[('columntransformer',
                                        ColumnTransformer(transformers=[('standardscaler',
                                                                         StandardScaler(),
                                                                         ['Age',
                                                                          'RestBP',
                                                                          'Chol',
                                                                          'RestECG',
                                                                          'MaxHR',
                                                                          'Oldpeak',
                                                                          'Slope',
                                                                          'Ca']),
                                                                        ('passthrough',
                                                                         'passthrough',
                                                                         ['Sex',
                                                                          'Fbs',
                                                                          'ExAng']),
                                                                        ('onehotencoder',
                                                                         OneHotEncoder(handle_unknown='ignore'),
                                                                         ['ChestPain',
                                                                          'Thal'])])),
                                       ('randomforestclas...
             param_grid={'randomforestclassifier__max_depth': [1, 3, 5, 7, 9],
                         'randomforestclassifier__max_features': [1, 2, 3, 4, 5,
                                                                  6, 7],
                         'randomforestclassifier__n_estimators': [200]},
             refit='accuracy',
             scoring={'accuracy': 'accuracy',
                      'precision': make_scorer(precision_score, response_method='predict', pos_label=Yes),
                      'recall': make_scorer(recall_score, response_method='predict', pos_label=Yes)})</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox"><label for="sk-estimator-id-1" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;GridSearchCV<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.model_selection.GridSearchCV.html">?<span>Documentation for GridSearchCV</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>GridSearchCV(cv=10,
             estimator=Pipeline(steps=[('columntransformer',
                                        ColumnTransformer(transformers=[('standardscaler',
                                                                         StandardScaler(),
                                                                         ['Age',
                                                                          'RestBP',
                                                                          'Chol',
                                                                          'RestECG',
                                                                          'MaxHR',
                                                                          'Oldpeak',
                                                                          'Slope',
                                                                          'Ca']),
                                                                        ('passthrough',
                                                                         'passthrough',
                                                                         ['Sex',
                                                                          'Fbs',
                                                                          'ExAng']),
                                                                        ('onehotencoder',
                                                                         OneHotEncoder(handle_unknown='ignore'),
                                                                         ['ChestPain',
                                                                          'Thal'])])),
                                       ('randomforestclas...
             param_grid={'randomforestclassifier__max_depth': [1, 3, 5, 7, 9],
                         'randomforestclassifier__max_features': [1, 2, 3, 4, 5,
                                                                  6, 7],
                         'randomforestclassifier__n_estimators': [200]},
             refit='accuracy',
             scoring={'accuracy': 'accuracy',
                      'precision': make_scorer(precision_score, response_method='predict', pos_label=Yes),
                      'recall': make_scorer(recall_score, response_method='predict', pos_label=Yes)})</pre></div> </div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox"><label for="sk-estimator-id-2" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">best_estimator_: Pipeline</label><div class="sk-toggleable__content fitted"><pre>Pipeline(steps=[('columntransformer',
                 ColumnTransformer(transformers=[('standardscaler',
                                                  StandardScaler(),
                                                  ['Age', 'RestBP', 'Chol',
                                                   'RestECG', 'MaxHR',
                                                   'Oldpeak', 'Slope', 'Ca']),
                                                 ('passthrough', 'passthrough',
                                                  ['Sex', 'Fbs', 'ExAng']),
                                                 ('onehotencoder',
                                                  OneHotEncoder(handle_unknown='ignore'),
                                                  ['ChestPain', 'Thal'])])),
                ('randomforestclassifier',
                 RandomForestClassifier(max_depth=1, max_features=2,
                                        n_estimators=200, random_state=2026))])</pre></div> </div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox"><label for="sk-estimator-id-3" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;columntransformer: ColumnTransformer<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.compose.ColumnTransformer.html">?<span>Documentation for columntransformer: ColumnTransformer</span></a></label><div class="sk-toggleable__content fitted"><pre>ColumnTransformer(transformers=[('standardscaler', StandardScaler(),
                                 ['Age', 'RestBP', 'Chol', 'RestECG', 'MaxHR',
                                  'Oldpeak', 'Slope', 'Ca']),
                                ('passthrough', 'passthrough',
                                 ['Sex', 'Fbs', 'ExAng']),
                                ('onehotencoder',
                                 OneHotEncoder(handle_unknown='ignore'),
                                 ['ChestPain', 'Thal'])])</pre></div> </div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-4" type="checkbox"><label for="sk-estimator-id-4" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">standardscaler</label><div class="sk-toggleable__content fitted"><pre>['Age', 'RestBP', 'Chol', 'RestECG', 'MaxHR', 'Oldpeak', 'Slope', 'Ca']</pre></div> </div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-5" type="checkbox"><label for="sk-estimator-id-5" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;StandardScaler<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.preprocessing.StandardScaler.html">?<span>Documentation for StandardScaler</span></a></label><div class="sk-toggleable__content fitted"><pre>StandardScaler()</pre></div> </div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-6" type="checkbox"><label for="sk-estimator-id-6" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">passthrough</label><div class="sk-toggleable__content fitted"><pre>['Sex', 'Fbs', 'ExAng']</pre></div> </div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-7" type="checkbox"><label for="sk-estimator-id-7" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">passthrough</label><div class="sk-toggleable__content fitted"><pre>passthrough</pre></div> </div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-8" type="checkbox"><label for="sk-estimator-id-8" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">onehotencoder</label><div class="sk-toggleable__content fitted"><pre>['ChestPain', 'Thal']</pre></div> </div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-9" type="checkbox"><label for="sk-estimator-id-9" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;OneHotEncoder<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.preprocessing.OneHotEncoder.html">?<span>Documentation for OneHotEncoder</span></a></label><div class="sk-toggleable__content fitted"><pre>OneHotEncoder(handle_unknown='ignore')</pre></div> </div></div></div></div></div></div></div><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-10" type="checkbox"><label for="sk-estimator-id-10" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;RandomForestClassifier<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.ensemble.RandomForestClassifier.html">?<span>Documentation for RandomForestClassifier</span></a></label><div class="sk-toggleable__content fitted"><pre>RandomForestClassifier(max_depth=1, max_features=2, n_estimators=200,
                       random_state=2026)</pre></div> </div></div></div></div></div></div></div></div></div></div></div>
</div>
</div>
</section>

<section id="precision-and-recall-contd" class="title-slide slide level2 center">
<h2>Precision and recall cont’d</h2>
<ul>
<li class="fragment"><p>What do we think? Is this model ready for production in a diagnostic setting?</p></li>
<li class="fragment"><p>How could we improve it further?</p></li>
</ul>
<div id="23a66cb3" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a></a>cv_results <span class="op">=</span> pd.DataFrame(rf_tune_grid.cv_results_)</span>
<span id="cb20-2"><a></a></span>
<span id="cb20-3"><a></a>mean_precision <span class="op">=</span> cv_results[<span class="st">'mean_test_precision'</span>].iloc[rf_tune_grid.best_index_]</span>
<span id="cb20-4"><a></a>sem_precision <span class="op">=</span> cv_results[<span class="st">'std_test_precision'</span>].iloc[rf_tune_grid.best_index_] <span class="op">/</span> np.sqrt(<span class="dv">10</span>)</span>
<span id="cb20-5"><a></a>mean_recall <span class="op">=</span> cv_results[<span class="st">'mean_test_recall'</span>].iloc[rf_tune_grid.best_index_]</span>
<span id="cb20-6"><a></a>sem_recall <span class="op">=</span> cv_results[<span class="st">'std_test_recall'</span>].iloc[rf_tune_grid.best_index_] <span class="op">/</span> np.sqrt(<span class="dv">10</span>)</span>
<span id="cb20-7"><a></a></span>
<span id="cb20-8"><a></a>results_rf_tuned <span class="op">=</span> pd.DataFrame({</span>
<span id="cb20-9"><a></a>    <span class="st">'mean'</span>: [rf_tune_grid.best_score_, mean_precision, mean_recall],</span>
<span id="cb20-10"><a></a>    <span class="st">'sem'</span>: [cv_results[<span class="st">'std_test_accuracy'</span>].iloc[rf_tune_grid.best_index_] <span class="op">/</span> np.sqrt(<span class="dv">10</span>), sem_precision, sem_recall],</span>
<span id="cb20-11"><a></a>}, index<span class="op">=</span>[<span class="st">'accuracy'</span>, <span class="st">'precision'</span>, <span class="st">'recall'</span>])</span>
<span id="cb20-12"><a></a></span>
<span id="cb20-13"><a></a>results_rf_tuned</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">sem</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">accuracy</td>
<td>0.860688</td>
<td>0.018576</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">precision</td>
<td>0.920505</td>
<td>0.022982</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">recall</td>
<td>0.770909</td>
<td>0.038928</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>

<section id="feature-importances" class="title-slide slide level2 center">
<h2>Feature importances</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Key points:</strong></p>
<ul>
<li class="fragment"><p>Decision trees are very interpretable (decision rules!), however in ensemble models (e.g., Random Forest and Boosting) there are many trees - individual decision rules are not as meaningful…</p></li>
<li class="fragment"><p>Instead, we can calculate feature importances as the total decrease in impurity for all splits involving that feature, weighted by the number of samples involved in those splits, normalized and averaged over all the trees.</p></li>
<li class="fragment"><p>These are calculated on the training set, as that is the set the model is trained on.</p></li>
</ul>
</div><div class="column" style="width:50%;">
<p><strong>Notes of caution!</strong></p>
<ul>
<li class="fragment"><p>Feature importances can be unreliable with both highly cardinal, and multicollinear features.</p></li>
<li class="fragment"><p>Unlike the linear model coefficients, feature importances do not have a sign! They tell us about importance, but not an “up or down”.</p></li>
<li class="fragment"><p>Increasing a feature may cause the prediction to first go up, and then go down.</p></li>
<li class="fragment"><p>Alternatives to feature importance to understanding models exist (e.g., <a href="https://shap.readthedocs.io/en/latest/example_notebooks/overviews/An%20introduction%20to%20explainable%20AI%20with%20Shapley%20values.html">SHAP</a> (SHapley Additive exPlanations))</p></li>
</ul>
</div></div>
</section>

<section id="feature-importances-in-scikit-learn" class="title-slide slide level2 center">
<h2>Feature importances in <code>scikit-learn</code></h2>
<div id="99040706" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a></a><span class="co"># Access the best pipeline</span></span>
<span id="cb21-2"><a></a>best_pipeline <span class="op">=</span> rf_tune_grid.best_estimator_</span>
<span id="cb21-3"><a></a></span>
<span id="cb21-4"><a></a><span class="co"># Extract the trained RandomForestClassifier from the pipeline</span></span>
<span id="cb21-5"><a></a>best_rf <span class="op">=</span> best_pipeline.named_steps[<span class="st">'randomforestclassifier'</span>]</span>
<span id="cb21-6"><a></a></span>
<span id="cb21-7"><a></a><span class="co"># Extract feature names after preprocessing</span></span>
<span id="cb21-8"><a></a><span class="co"># Get the names of features from each transformer in the pipeline</span></span>
<span id="cb21-9"><a></a>numeric_features <span class="op">=</span> numeric_feats</span>
<span id="cb21-10"><a></a>categorical_feature_names <span class="op">=</span> best_pipeline.named_steps[<span class="st">'columntransformer'</span>].transformers_[<span class="dv">2</span>][<span class="dv">1</span>].get_feature_names_out(categorical_feats)</span>
<span id="cb21-11"><a></a>passthrough_features <span class="op">=</span> passthrough_feats</span>
<span id="cb21-12"><a></a></span>
<span id="cb21-13"><a></a><span class="co"># Combine all feature names into a single list</span></span>
<span id="cb21-14"><a></a>feature_names <span class="op">=</span> np.concatenate([numeric_features, passthrough_features, categorical_feature_names])</span>
<span id="cb21-15"><a></a></span>
<span id="cb21-16"><a></a><span class="co"># Calculate feature importances</span></span>
<span id="cb21-17"><a></a>feature_importances <span class="op">=</span> best_rf.feature_importances_</span>
<span id="cb21-18"><a></a></span>
<span id="cb21-19"><a></a><span class="co"># Create a DataFrame to display feature importances</span></span>
<span id="cb21-20"><a></a>importances_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb21-21"><a></a>    <span class="st">'Feature'</span>: feature_names,</span>
<span id="cb21-22"><a></a>    <span class="st">'Importance'</span>: feature_importances</span>
<span id="cb21-23"><a></a>})</span>
<span id="cb21-24"><a></a></span>
<span id="cb21-25"><a></a><span class="co"># Sort by importance (descending order)</span></span>
<span id="cb21-26"><a></a>importances_df <span class="op">=</span> importances_df.sort_values(by<span class="op">=</span><span class="st">'Importance'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>

<section id="visualizing-the-results" class="title-slide slide level2 center">
<h2>Visualizing the results</h2>
<div id="1cf91009" class="cell" data-execution_count="20">
<div class="cell-output cell-output-display" data-execution_count="20">

<style>
  #altair-viz-0781357c83c64fef9cddc502aa36752c.vega-embed {
    width: 100%;
    display: flex;
  }

  #altair-viz-0781357c83c64fef9cddc502aa36752c.vega-embed details,
  #altair-viz-0781357c83c64fef9cddc502aa36752c.vega-embed details summary {
    position: relative;
  }
</style>
<div id="altair-viz-0781357c83c64fef9cddc502aa36752c"></div>
<script type="text/javascript">
  var VEGA_DEBUG = (typeof VEGA_DEBUG == "undefined") ? {} : VEGA_DEBUG;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-0781357c83c64fef9cddc502aa36752c") {
      outputDiv = document.getElementById("altair-viz-0781357c83c64fef9cddc502aa36752c");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm/vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm/vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm/vega-lite@5.20.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm/vega-embed@6?noext",
    };

    function maybeLoadScript(lib, version) {
      var key = `${lib.replace("-", "")}_version`;
      return (VEGA_DEBUG[key] == version) ?
        Promise.resolve(paths[lib]) :
        new Promise(function(resolve, reject) {
          var s = document.createElement('script');
          document.getElementsByTagName("head")[0].appendChild(s);
          s.async = true;
          s.onload = () => {
            VEGA_DEBUG[key] = version;
            return resolve(paths[lib]);
          };
          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
          s.src = paths[lib];
        });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else {
      maybeLoadScript("vega", "5")
        .then(() => maybeLoadScript("vega-lite", "5.20.1"))
        .then(() => maybeLoadScript("vega-embed", "6"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-7005ae860b862694fb01f227f5e98385"}, "mark": {"type": "bar"}, "encoding": {"tooltip": [{"field": "Feature", "type": "nominal"}, {"field": "Importance", "type": "quantitative"}], "x": {"field": "Importance", "title": "Feature Importance", "type": "quantitative"}, "y": {"field": "Feature", "sort": "-x", "title": "Feature", "type": "nominal"}}, "height": 400, "title": "Feature Importances from Random Forest Model", "width": 600, "$schema": "https://vega.github.io/schema/vega-lite/v5.20.1.json", "datasets": {"data-7005ae860b862694fb01f227f5e98385": [{"Feature": "ChestPain_asymptomatic", "Importance": 0.14}, {"Feature": "ExAng", "Importance": 0.11}, {"Feature": "Ca", "Importance": 0.105}, {"Feature": "MaxHR", "Importance": 0.09}, {"Feature": "Thal_normal", "Importance": 0.085}, {"Feature": "Thal_reversable", "Importance": 0.075}, {"Feature": "Slope", "Importance": 0.065}, {"Feature": "Oldpeak", "Importance": 0.065}, {"Feature": "ChestPain_nontypical", "Importance": 0.06}, {"Feature": "Age", "Importance": 0.045}, {"Feature": "Chol", "Importance": 0.04}, {"Feature": "RestBP", "Importance": 0.035}, {"Feature": "Sex", "Importance": 0.035}, {"Feature": "ChestPain_nonanginal", "Importance": 0.02}, {"Feature": "ChestPain_typical", "Importance": 0.015}, {"Feature": "RestECG", "Importance": 0.015}, {"Feature": "Fbs", "Importance": 0.0}, {"Feature": "Thal_fixed", "Importance": 0.0}]}}, {"mode": "vega-lite"});
</script>
</div>
</div>
</section>

<section id="evaluating-on-the-test-set" class="title-slide slide level2 center">
<h2>Evaluating on the test set</h2>
<p>Predict on the test set:</p>
<div id="ce873aed" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a></a>heart_test_drop_na <span class="op">=</span> heart_test.dropna()</span>
<span id="cb22-2"><a></a>X_test_drop_na <span class="op">=</span> heart_test_drop_na.drop(columns<span class="op">=</span>[<span class="st">'AHD'</span>])</span>
<span id="cb22-3"><a></a>y_test_drop_na <span class="op">=</span> heart_test_drop_na[<span class="st">'AHD'</span>]</span>
<span id="cb22-4"><a></a></span>
<span id="cb22-5"><a></a>heart_test_drop_na[<span class="st">"predicted"</span>] <span class="op">=</span> rf_tune_grid.predict(</span>
<span id="cb22-6"><a></a>    X_test_drop_na</span>
<span id="cb22-7"><a></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>

<section id="evaluating-on-the-test-set-1" class="title-slide slide level2 center">
<h2>Evaluating on the test set</h2>
<p>Examine accuracy, precision and recall:</p>
<div class="columns">
<div class="column" style="width:50%;">
<div id="24a1f0ad" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a></a>rf_tune_grid.score(</span>
<span id="cb23-2"><a></a>    X_test_drop_na,</span>
<span id="cb23-3"><a></a>    y_test_drop_na</span>
<span id="cb23-4"><a></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>0.7868852459016393</code></pre>
</div>
</div>
<div id="46e0e896" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a></a>precision_score(</span>
<span id="cb25-2"><a></a>    y_true<span class="op">=</span>heart_test_drop_na[<span class="st">"AHD"</span>],</span>
<span id="cb25-3"><a></a>    y_pred<span class="op">=</span>heart_test_drop_na[<span class="st">"predicted"</span>],</span>
<span id="cb25-4"><a></a>    pos_label<span class="op">=</span><span class="st">'Yes'</span></span>
<span id="cb25-5"><a></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>np.float64(0.8)</code></pre>
</div>
</div>
<div id="e0498c8a" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a></a>recall_score(</span>
<span id="cb27-2"><a></a>    y_true<span class="op">=</span>heart_test_drop_na[<span class="st">"AHD"</span>],</span>
<span id="cb27-3"><a></a>    y_pred<span class="op">=</span>heart_test_drop_na[<span class="st">"predicted"</span>],</span>
<span id="cb27-4"><a></a>    pos_label<span class="op">=</span><span class="st">'Yes'</span></span>
<span id="cb27-5"><a></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>np.float64(0.7142857142857143)</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div id="4023a468" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a></a>conf_matrix <span class="op">=</span> pd.crosstab(</span>
<span id="cb29-2"><a></a>    heart_test_drop_na[<span class="st">"AHD"</span>],</span>
<span id="cb29-3"><a></a>    heart_test_drop_na[<span class="st">"predicted"</span>]</span>
<span id="cb29-4"><a></a>)</span>
<span id="cb29-5"><a></a><span class="bu">print</span>(conf_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>predicted  No  Yes
AHD               
No         28    5
Yes         8   20</code></pre>
</div>
</div>
</div></div>
</section>

<section id="other-boosting-models" class="title-slide slide level2 center">
<h2>Other boosting models:</h2>
<div>
<div class="columns">
<div class="column" style="width:50%;">
<p><a href="https://lightgbm.readthedocs.io/">XGBoost</a></p>
<ul>
<li>Not part of <code>sklearn</code> but has similar interface.</li>
<li>Supports missing values</li>
<li>GPU training, networked parallel training</li>
<li>Supports sparse data</li>
<li>Typically better scores than random forests</li>
</ul>
</div><div class="column" style="width:50%;">
<p><a href="https://lightgbm.readthedocs.io/">LightGBM</a></p>
<ul>
<li>Not part of sklearn but has similar interface.</li>
<li>Small model size</li>
<li>Faster</li>
<li>Typically better scores than random forests</li>
</ul>
<p><a href="https://catboost.ai/">CatBoost</a></p>
<ul>
<li>Not part of sklearn but has similar interface.</li>
<li>Usually better scores but slower compared to XGBoost and LightGBM</li>
</ul>
</div></div>
</div>
</section>

<section id="keep-learning" class="title-slide slide level2 center">
<h2>Keep learning!</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/frontmatter/ds-a-first-intro-cover-python.jpeg" style="height:50.0%"> <a href="https://python.datasciencebook.ca/" class="uri">https://python.datasciencebook.ca/</a></p>
</div><div class="column" style="width:50%;">
<p><img data-src="img/frontmatter/ISLP_cover.png" style="height:50.0%"> <a href="https://www.statlearning.com/" class="uri">https://www.statlearning.com/</a></p>
</div></div>
</section>

<section id="local-installation" class="title-slide slide level2 center">
<h2>Local installation</h2>
<ol type="1">
<li class="fragment"><p>Using Docker: <a href="https://python.datasciencebook.ca/setup.html">Data Science: A First Introduction (Python Edition) Installation Instructions</a></p></li>
<li class="fragment"><p>Using conda: <a href="https://ubc-mds.github.io/resources_pages/installation_instructions/">UBC MDS Installation Instructions</a></p></li>
</ol>
</section>

<section id="additional-resources" class="title-slide slide level2 center">
<h2>Additional resources</h2>
<ul>
<li class="fragment">The <a href="https://ubc-mds.github.io/DSCI_573_feat-model-select">UBC DSCI 573 (Feature and Model Selection notes)</a> chapter of Data Science: A First Introduction (Python Edition) by Varada Kolhatkar and Joel Ostblom. These notes cover classification and regression metrics, advanced variable selection and more on ensembles.</li>
<li class="fragment">The <a href="https://scikit-learn.org/stable/"><code>scikit-learn</code> website</a> is an excellent reference for more details on, and advanced usage of, the functions and packages in the past two chapters. Aside from that, it also offers many useful <a href="https://scikit-learn.org/stable/tutorial/index.html">tutorials</a> to get you started.</li>
<li class="fragment"><a href="https://www.statlearning.com/"><em>An Introduction to Statistical Learning</em></a> {cite:p}<code>james2013introduction</code> provides a great next stop in the process of learning about classification. Chapter 4 discusses additional basic techniques for classification that we do not cover, such as logistic regression, linear discriminant analysis, and naive Bayes.</li>
</ul>
</section>

<section id="references" class="title-slide slide level2 center">
<h2>References</h2>
<p>Gareth James, Daniela Witten, Trevor Hastie, Robert Tibshirani and Jonathan Taylor. An Introduction to Statistical Learning with Applications in Python. Springer, 1st edition, 2023. URL: https://www.statlearning.com/.</p>
<p>Kolhatkar, V., and Ostblom, J. (2024). UBC DSCI 573: Feature and Model Selection course notes. URL: https://ubc-mds.github.io/DSCI_573_feat-model-select</p>
<p>Pedregosa, F. et al., 2011. Scikit-learn: Machine learning in Python. Journal of machine learning research, 12(Oct), pp.2825–2830.</p>

<div class="quarto-auto-generated-content">
<div class="footer footer-default">

</div>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': true,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp("https:\/\/posit-conf-2024\.github\.io\/ml-python\/");
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>